<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rental Inquiry - Texas Tough Rentals</title>
  <meta name="description" content="Submit a rental inquiry for Texas Tough Rentals trailers. Quick and easy online form.">
  <link rel="stylesheet" href="/src/css/style.css">
  
  <!-- Import Map for Zod -->
  <script type="importmap">
    {
      "imports": {
        "zod": "https://cdn.jsdelivr.net/npm/zod@3.22.4/+esm"
      }
    }
  </script>
</head>
<body>
  <header>
    <nav class="container">
      <div class="logo">ðŸšš Texas Tough Rentals</div>
      <ul class="nav-links">
        <li><a href="/">Home</a></li>
        <li><a href="/inquiry.html">Rent a Trailer</a></li>
        <li><a href="/#about">About</a></li>
        <li><a href="/#contact">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main class="container">
    <section class="content-section">
      <h2>Trailer Rental Inquiry</h2>
      <p>Fill out the form below to inquire about renting a trailer. We'll get back to you as soon as possible!</p>
      
      <div class="form-container">
        <div class="form-success" id="successMessage">
          <strong>Success!</strong> Your inquiry has been submitted. We'll contact you shortly.
        </div>

        <form id="inquiryForm" novalidate>
          <div class="form-group">
            <label for="name">Full Name <span style="color: red;">*</span></label>
            <input 
              type="text" 
              id="name" 
              name="name" 
              required 
              placeholder="John Doe"
            >
            <div class="form-error" id="nameError"></div>
          </div>

          <div class="form-group">
            <label for="email">Email Address <span style="color: red;">*</span></label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              required 
              placeholder="john@example.com"
            >
            <div class="form-error" id="emailError"></div>
          </div>

          <div class="form-group">
            <label for="phone">Phone Number <span style="color: red;">*</span></label>
            <input 
              type="tel" 
              id="phone" 
              name="phone" 
              required 
              placeholder="555-123-4567"
            >
            <div class="form-error" id="phoneError"></div>
          </div>

          <div class="form-group">
            <label for="trailerType">Trailer Type <span style="color: red;">*</span></label>
            <select id="trailerType" name="trailerType" required>
              <option value="">Select a trailer type...</option>
              <option value="utility">Utility Trailer</option>
              <option value="enclosed">Enclosed Trailer</option>
              <option value="flatbed">Flatbed Trailer</option>
              <option value="dump">Dump Trailer</option>
              <option value="car-hauler">Car Hauler Trailer</option>
            </select>
            <div class="form-error" id="trailerTypeError"></div>
          </div>

          <div class="form-group">
            <label for="rentalDate">Rental Start Date <span style="color: red;">*</span></label>
            <input 
              type="date" 
              id="rentalDate" 
              name="rentalDate" 
              required
            >
            <div class="form-error" id="rentalDateError"></div>
          </div>

          <div class="form-group">
            <label for="duration">Rental Duration (days) <span style="color: red;">*</span></label>
            <input 
              type="number" 
              id="duration" 
              name="duration" 
              required 
              min="1" 
              max="30" 
              placeholder="1"
            >
            <div class="form-error" id="durationError"></div>
          </div>

          <div class="form-group">
            <label for="message">Additional Information (Optional)</label>
            <textarea 
              id="message" 
              name="message" 
              placeholder="Tell us about your rental needs..."
            ></textarea>
            <div class="form-error" id="messageError"></div>
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%;">
            Submit Inquiry
          </button>
        </form>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="footer-content">
        <ul class="footer-links">
          <li><a href="/">Home</a></li>
          <li><a href="/inquiry.html">Rent a Trailer</a></li>
          <li><a href="/#about">About</a></li>
          <li><a href="/#contact">Contact</a></li>
        </ul>
        <p>&copy; 2024 Texas Tough Rentals. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Form validation script using Zod -->
  <script type="module">
    import { inquirySchema, validateFormData } from '/src/js/schemas.js';

    const form = document.getElementById('inquiryForm');
    const successMessage = document.getElementById('successMessage');

    // Pre-fill trailer type from URL parameter if present
    const urlParams = new URLSearchParams(window.location.search);
    const typeParam = urlParams.get('type');
    if (typeParam) {
      const trailerTypeSelect = document.getElementById('trailerType');
      trailerTypeSelect.value = typeParam;
    }

    // Set minimum date to today
    const rentalDateInput = document.getElementById('rentalDate');
    const today = new Date().toISOString().split('T')[0];
    rentalDateInput.min = today;

    // Clear error on input
    form.querySelectorAll('input, select, textarea').forEach(field => {
      field.addEventListener('input', () => {
        const errorElement = document.getElementById(`${field.name}Error`);
        if (errorElement) {
          errorElement.textContent = '';
          errorElement.classList.remove('show');
          field.closest('.form-group').classList.remove('error');
        }
      });
    });

    // Form submission handler
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Clear previous errors
      form.querySelectorAll('.form-error').forEach(error => {
        error.textContent = '';
        error.classList.remove('show');
      });
      form.querySelectorAll('.form-group').forEach(group => {
        group.classList.remove('error');
      });
      successMessage.classList.remove('show');

      // Collect form data
      const formData = new FormData(form);
      const data = {
        name: formData.get('name'),
        email: formData.get('email'),
        phone: formData.get('phone'),
        trailerType: formData.get('trailerType'),
        rentalDate: formData.get('rentalDate'),
        duration: formData.get('duration'),
        message: formData.get('message') || undefined
      };

      // Validate using Zod
      const result = validateFormData(inquirySchema, data);

      if (result.success) {
        // Success! Show success message
        console.log('Form validated successfully:', result.data);
        successMessage.classList.add('show');
        form.reset();
        
        // Scroll to success message
        successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });

        // In a real application, you would send this data to a server
        // Example: await fetch('/api/inquiries', { method: 'POST', body: JSON.stringify(result.data) });
      } else {
        // Show validation errors
        console.error('Validation errors:', result.errors);
        
        Object.keys(result.errors).forEach(fieldName => {
          const errorElement = document.getElementById(`${fieldName}Error`);
          const formGroup = document.getElementById(fieldName)?.closest('.form-group');
          
          if (errorElement) {
            errorElement.textContent = result.errors[fieldName];
            errorElement.classList.add('show');
            formGroup?.classList.add('error');
          }
        });

        // Scroll to first error
        const firstError = form.querySelector('.form-group.error');
        if (firstError) {
          firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      }
    });
  </script>
</body>
</html>
